--// Destroy other instances
for _,v in pairs(game.CoreGui:GetChildren()) do
    if v.Name == "dark_UI" then
        v:Destroy()
    end
end

local dark_UI = Instance.new("ScreenGui")
dark_UI.Name = "dark_UI"
dark_UI.ZIndexBehavior = Enum.ZIndexBehavior.Sibling
dark_UI.Parent = game.CoreGui

local Library = {}
local TweenService = game:GetService("TweenService")
local RunService = game:GetService("RunService")
local UserInputService = game:GetService("UserInputService")
local Players = game:GetService("Players")
local LocalPlayer = Players.LocalPlayer
local Mouse = LocalPlayer:GetMouse()

-- Mobile detection
local isMobile = UserInputService.TouchEnabled and not UserInputService.KeyboardEnabled

function Library:Create(table)
    local windowName = table.Name

    local main = Instance.new("Frame")
    main.Name = "main"
    main.BackgroundColor3 = Color3.fromRGB(40, 40, 40)
    main.Position = UDim2.fromScale(0.5, 0.5)
    main.Size = UDim2.fromOffset(500, 400)
    main.AnchorPoint = Vector2.new(0.5, 0.5)

    local uICorner = Instance.new("UICorner")
    uICorner.CornerRadius = UDim.new(0, 12)
    uICorner.Parent = main

    -- Top bar
    local topBar = Instance.new("Frame")
    topBar.Name = "topBar"
    topBar.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
    topBar.Size = UDim2.new(1, 0, 0, 50)
    topBar.Parent = main

    local topBarCorner = Instance.new("UICorner")
    topBarCorner.CornerRadius = UDim.new(0, 12)
    topBarCorner.Parent = topBar

    -- Menu button (three lines)
    local menuButton = Instance.new("TextButton")
    menuButton.Name = "menuButton"
    menuButton.Text = ""
    menuButton.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
    menuButton.BackgroundTransparency = 1
    menuButton.Position = UDim2.fromOffset(15, 12)
    menuButton.Size = UDim2.fromOffset(26, 26)
    menuButton.Parent = topBar

    -- Three lines icon
    for i = 0, 2 do
        local line = Instance.new("Frame")
        line.BackgroundColor3 = Color3.fromRGB(200, 200, 200)
        line.BorderSizePixel = 0
        line.Position = UDim2.fromOffset(2, 6 + (i * 7))
        line.Size = UDim2.fromOffset(22, 2)
        line.Parent = menuButton
        
        local lineCorner = Instance.new("UICorner")
        lineCorner.CornerRadius = UDim.new(1, 0)
        lineCorner.Parent = line
    end

    -- Title
    local title = Instance.new("TextLabel")
    title.Name = "title"
    title.Font = Enum.Font.GothamBold
    title.Text = windowName
    title.TextColor3 = Color3.fromRGB(255, 255, 255)
    title.TextSize = 16
    title.BackgroundTransparency = 1
    title.Position = UDim2.fromOffset(50, 0)
    title.Size = UDim2.new(1, -100, 1, 0)
    title.TextXAlignment = Enum.TextXAlignment.Left
    title.Parent = topBar

    -- Search button
    local searchButton = Instance.new("ImageButton")
    searchButton.Name = "searchButton"
    searchButton.Image = "rbxassetid://7072707729"
    searchButton.ImageColor3 = Color3.fromRGB(200, 200, 200)
    searchButton.BackgroundTransparency = 1
    searchButton.Position = UDim2.new(1, -70, 0.5, -12)
    searchButton.Size = UDim2.fromOffset(24, 24)
    searchButton.Parent = topBar

    -- Close button
    local closeButton = Instance.new("TextButton")
    closeButton.Name = "closeButton"
    closeButton.Text = "×"
    closeButton.Font = Enum.Font.GothamBold
    closeButton.TextSize = 24
    closeButton.TextColor3 = Color3.fromRGB(200, 200, 200)
    closeButton.BackgroundTransparency = 1
    closeButton.Position = UDim2.new(1, -40, 0.5, -12)
    closeButton.Size = UDim2.fromOffset(24, 24)
    closeButton.Parent = topBar

    -- Settings button (three dots)
    local settingsButton = Instance.new("TextButton")
    settingsButton.Name = "settingsButton"
    settingsButton.Text = "⋮"
    settingsButton.Font = Enum.Font.GothamBold
    settingsButton.TextSize = 20
    settingsButton.TextColor3 = Color3.fromRGB(200, 200, 200)
    settingsButton.BackgroundTransparency = 1
    settingsButton.Position = UDim2.new(1, -100, 0.5, -12)
    settingsButton.Size = UDim2.fromOffset(24, 24)
    settingsButton.Parent = topBar

    -- Fix top bar corners
    local topBarCover = Instance.new("Frame")
    topBarCover.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
    topBarCover.BorderSizePixel = 0
    topBarCover.Position = UDim2.new(0, 0, 1, -12)
    topBarCover.Size = UDim2.new(1, 0, 0, 12)
    topBarCover.Parent = topBar

    -- Side menu (tabs)
    local sideMenu = Instance.new("Frame")
    sideMenu.Name = "sideMenu"
    sideMenu.BackgroundColor3 = Color3.fromRGB(35, 35, 35)
    sideMenu.Position = UDim2.fromOffset(-200, 50)
    sideMenu.Size = UDim2.fromOffset(200, 350)
    sideMenu.ClipsDescendants = true
    sideMenu.Visible = false
    sideMenu.ZIndex = 10
    sideMenu.Parent = main

    local sideMenuCorner = Instance.new("UICorner")
    sideMenuCorner.CornerRadius = UDim.new(0, 8)
    sideMenuCorner.Parent = sideMenu

    local tabList = Instance.new("ScrollingFrame")
    tabList.Name = "tabList"
    tabList.BackgroundTransparency = 1
    tabList.BorderSizePixel = 0
    tabList.Size = UDim2.new(1, 0, 1, 0)
    tabList.ScrollBarThickness = 4
    tabList.ScrollBarImageColor3 = Color3.fromRGB(80, 80, 80)
    tabList.Parent = sideMenu

    local tabListLayout = Instance.new("UIListLayout")
    tabListLayout.Padding = UDim.new(0, 2)
    tabListLayout.SortOrder = Enum.SortOrder.LayoutOrder
    tabListLayout.Parent = tabList

    local tabListPadding = Instance.new("UIPadding")
    tabListPadding.PaddingTop = UDim.new(0, 8)
    tabListPadding.PaddingLeft = UDim.new(0, 8)
    tabListPadding.PaddingRight = UDim.new(0, 8)
    tabListPadding.Parent = tabList

    -- Content container
    local contentContainer = Instance.new("Frame")
    contentContainer.Name = "contentContainer"
    contentContainer.BackgroundTransparency = 1
    contentContainer.Position = UDim2.fromOffset(0, 50)
    contentContainer.Size = UDim2.new(1, 0, 1, -50)
    contentContainer.Parent = main

    local shadow = Instance.new("ImageLabel")
    shadow.Name = "shadow"
    shadow.Image = "rbxassetid://297774371"
    shadow.ImageColor3 = Color3.fromRGB(0, 0, 0)
    shadow.ImageTransparency = 0.5
    shadow.SliceCenter = Rect.new(20, 20, 280, 280)
    shadow.BackgroundTransparency = 1
    shadow.Position = UDim2.fromScale(0.5, 0.5)
    shadow.AnchorPoint = Vector2.new(0.5, 0.5)
    shadow.Size = UDim2.fromOffset(540, 440)
    shadow.ZIndex = -1
    shadow.Parent = dark_UI

    main.Parent = dark_UI

    local menuOpen = false

    -- Menu button click
    menuButton.MouseButton1Click:Connect(function()
        menuOpen = not menuOpen
        if menuOpen then
            sideMenu.Visible = true
            TweenService:Create(sideMenu, TweenInfo.new(0.3, Enum.EasingStyle.Quart, Enum.EasingDirection.Out), {Position = UDim2.fromOffset(0, 50)}):Play()
        else
            TweenService:Create(sideMenu, TweenInfo.new(0.3, Enum.EasingStyle.Quart, Enum.EasingDirection.Out), {Position = UDim2.fromOffset(-200, 50)}):Play()
            task.wait(0.3)
            sideMenu.Visible = false
        end
    end)

    local tabHandler = {}

    function tabHandler:Exit()
        dark_UI:Destroy()
    end

    closeButton.MouseButton1Click:Connect(function()
        tabHandler:Exit()
    end)

    function tabHandler:Tab(name)
        -- Create tab button in side menu
        local tabButton = Instance.new("TextButton")
        tabButton.Name = name
        tabButton.Font = Enum.Font.Gotham
        tabButton.Text = name
        tabButton.TextColor3 = Color3.fromRGB(200, 200, 200)
        tabButton.TextSize = 14
        tabButton.TextXAlignment = Enum.TextXAlignment.Left
        tabButton.BackgroundColor3 = Color3.fromRGB(45, 45, 45)
        tabButton.BackgroundTransparency = 0.5
        tabButton.Size = UDim2.new(1, -8, 0, 36)
        tabButton.AutoButtonColor = false
        tabButton.Parent = tabList

        local tabButtonCorner = Instance.new("UICorner")
        tabButtonCorner.CornerRadius = UDim.new(0, 6)
        tabButtonCorner.Parent = tabButton

        local tabButtonPadding = Instance.new("UIPadding")
        tabButtonPadding.PaddingLeft = UDim.new(0, 12)
        tabButtonPadding.Parent = tabButton

        -- Create container for this tab
        local container = Instance.new("Frame")
        container.Name = "container"
        container.BackgroundTransparency = 1
        container.Size = UDim2.new(1, 0, 1, 0)
        container.Visible = false
        container.Parent = contentContainer
        
        local holder = Instance.new("ScrollingFrame")
        holder.Name = "holder"
        holder.ScrollBarImageColor3 = Color3.fromRGB(80, 80, 80)
        holder.ScrollBarThickness = 4
        holder.ScrollingDirection = Enum.ScrollingDirection.Y
        holder.Active = true
        holder.BackgroundTransparency = 1
        holder.BorderSizePixel = 0
        holder.Size = UDim2.new(1, 0, 1, 0)
        holder.Parent = container

        local uIPadding1 = Instance.new("UIPadding")
        uIPadding1.PaddingLeft = UDim.new(0, 15)
        uIPadding1.PaddingRight = UDim.new(0, 15)
        uIPadding1.PaddingTop = UDim.new(0, 15)
        uIPadding1.PaddingBottom = UDim.new(0, 15)
        uIPadding1.Parent = holder

        local uIListLayout1 = Instance.new("UIListLayout")
        uIListLayout1.Padding = UDim.new(0, 8)
        uIListLayout1.SortOrder = Enum.SortOrder.LayoutOrder
        uIListLayout1.Parent = holder

        -- Tab button click
        tabButton.MouseButton1Click:Connect(function()
            -- Hide all containers
            for _, v in pairs(contentContainer:GetChildren()) do
                if v.Name == "container" then
                    v.Visible = false
                end
            end
            -- Reset all tab buttons
            for _, v in pairs(tabList:GetChildren()) do
                if v:IsA('TextButton') then
                    TweenService:Create(v, TweenInfo.new(0.2), {BackgroundTransparency = 0.5, TextColor3 = Color3.fromRGB(200, 200, 200)}):Play()
                end
            end
            -- Show this container
            container.Visible = true
            TweenService:Create(tabButton, TweenInfo.new(0.2), {BackgroundTransparency = 0, TextColor3 = Color3.fromRGB(255, 255, 255)}):Play()
            
            -- Close menu
            menuOpen = false
            TweenService:Create(sideMenu, TweenInfo.new(0.3, Enum.EasingStyle.Quart, Enum.EasingDirection.Out), {Position = UDim2.fromOffset(-200, 50)}):Play()
            task.wait(0.3)
            sideMenu.Visible = false
        end)

        local ElementHandler = {}
        
        function ElementHandler:Label(text)
            local label = Instance.new("Frame")
            label.Name = "label"
            label.BackgroundTransparency = 1
            label.Size = UDim2.new(1, 0, 0, 24)
            label.Parent = holder
    
            local textLabel = Instance.new("TextLabel")
            textLabel.Font = Enum.Font.Gotham
            textLabel.Text = text
            textLabel.TextColor3 = Color3.fromRGB(200, 200, 200)
            textLabel.TextSize = 13
            textLabel.TextXAlignment = Enum.TextXAlignment.Left
            textLabel.BackgroundTransparency = 1
            textLabel.Size = UDim2.new(1, 0, 1, 0)
            textLabel.Parent = label
        end

        function ElementHandler:Button(text, callback)
            text = text or "Button"
            callback = callback or function() end

            local button = Instance.new("TextButton")
            button.Name = "button"
            button.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
            button.Size = UDim2.new(1, 0, 0, 40)
            button.Text = ""
            button.AutoButtonColor = false

            local uICorner12 = Instance.new("UICorner")
            uICorner12.CornerRadius = UDim.new(0, 8)
            uICorner12.Parent = button

            local textLabel5 = Instance.new("TextLabel")
            textLabel5.Font = Enum.Font.Gotham
            textLabel5.Text = text
            textLabel5.TextColor3 = Color3.fromRGB(220, 220, 220)
            textLabel5.TextSize = 14
            textLabel5.TextXAlignment = Enum.TextXAlignment.Left
            textLabel5.BackgroundTransparency = 1
            textLabel5.Position = UDim2.fromOffset(15, 0)
            textLabel5.Size = UDim2.new(1, -15, 1, 0)
            textLabel5.Parent = button

            button.Parent = holder

            button.MouseEnter:Connect(function()
                TweenService:Create(button, TweenInfo.new(0.2), {BackgroundColor3 = Color3.fromRGB(60, 60, 60)}):Play()
            end)

            button.MouseLeave:Connect(function()
                TweenService:Create(button, TweenInfo.new(0.2), {BackgroundColor3 = Color3.fromRGB(50, 50, 50)}):Play()
            end)

            button.MouseButton1Click:Connect(function()
                callback()
            end)
        end

        function ElementHandler:Slider(text, min, max, default, callback)
            text = text or "Slider"
            min = min or 0
            max = max or 100
            default = default or min
            callback = callback or function() end

            local slider = Instance.new("Frame")
            slider.Name = "slider"
            slider.BackgroundTransparency = 1
            slider.Size = UDim2.new(1, 0, 0, 50)
            slider.Parent = holder

            local sliderLabel = Instance.new("TextLabel")
            sliderLabel.Font = Enum.Font.Gotham
            sliderLabel.Text = text
            sliderLabel.TextColor3 = Color3.fromRGB(200, 200, 200)
            sliderLabel.TextSize = 13
            sliderLabel.TextXAlignment = Enum.TextXAlignment.Left
            sliderLabel.BackgroundTransparency = 1
            sliderLabel.Size = UDim2.new(0.7, 0, 0, 20)
            sliderLabel.Parent = slider

            local valueLabel = Instance.new("TextLabel")
            valueLabel.Font = Enum.Font.GothamBold
            valueLabel.Text = tostring(default)
            valueLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
            valueLabel.TextSize = 14
            valueLabel.TextXAlignment = Enum.TextXAlignment.Right
            valueLabel.BackgroundTransparency = 1
            valueLabel.Position = UDim2.new(0.7, 0, 0, 0)
            valueLabel.Size = UDim2.new(0.3, 0, 0, 20)
            valueLabel.Parent = slider

            local sliderButton = Instance.new("TextButton")
            sliderButton.Name = "sliderButton"
            sliderButton.Text = ""
            sliderButton.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
            sliderButton.Position = UDim2.fromOffset(0, 28)
            sliderButton.Size = UDim2.new(1, 0, 0, 8)
            sliderButton.AutoButtonColor = false
            sliderButton.Parent = slider

            local sliderCorner = Instance.new("UICorner")
            sliderCorner.CornerRadius = UDim.new(1, 0)
            sliderCorner.Parent = sliderButton

            local sliderFill = Instance.new("Frame")
            sliderFill.Name = "sliderFill"
            sliderFill.BackgroundColor3 = Color3.fromRGB(100, 150, 255)
            sliderFill.Size = UDim2.new(0, 0, 1, 0)
            sliderFill.Parent = sliderButton

            local fillCorner = Instance.new("UICorner")
            fillCorner.CornerRadius = UDim.new(1, 0)
            fillCorner.Parent = sliderFill

            local dragging = false
            
            local percentage = (default - min) / (max - min)
            sliderFill.Size = UDim2.new(percentage, 0, 1, 0)

            local function update(input)
                local pos = input.Position
                local relativeX = pos.X - sliderButton.AbsolutePosition.X
                local percentage = math.clamp(relativeX / sliderButton.AbsoluteSize.X, 0, 1)
                local value = math.floor(min + (max - min) * percentage)
                
                valueLabel.Text = tostring(value)
                TweenService:Create(sliderFill, TweenInfo.new(0.05), {Size = UDim2.new(percentage, 0, 1, 0)}):Play()
                callback(value)
            end

            sliderButton.InputBegan:Connect(function(input)
                if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then
                    dragging = true
                    update(input)
                end
            end)

            sliderButton.InputEnded:Connect(function(input)
                if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then
                    dragging = false
                end
            end)

            UserInputService.InputChanged:Connect(function(input)
                if dragging and (input.UserInputType == Enum.UserInputType.MouseMovement or input.UserInputType == Enum.UserInputType.Touch) then
                    update(input)
                end
            end)
        end

        function ElementHandler:Toggle(text, callback)
            text = text or "Toggle"
            callback = callback or function() end

            local toggle1 = Instance.new("TextButton")
            toggle1.Name = "toggle1"
            toggle1.BackgroundTransparency = 1
            toggle1.Size = UDim2.new(1, 0, 0, 40)
            toggle1.Text = ""
            toggle1.AutoButtonColor = false
            toggle1.Parent = holder

            local textLabel4 = Instance.new("TextLabel")
            textLabel4.Font = Enum.Font.Gotham
            textLabel4.Text = text
            textLabel4.TextColor3 = Color3.fromRGB(220, 220, 220)
            textLabel4.TextSize = 14
            textLabel4.TextXAlignment = Enum.TextXAlignment.Left
            textLabel4.BackgroundTransparency = 1
            textLabel4.Size = UDim2.new(0.8, 0, 1, 0)
            textLabel4.Parent = toggle1

            local toggleBox = Instance.new("Frame")
            toggleBox.Name = "toggleBox"
            toggleBox.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
            toggleBox.Position = UDim2.new(1, -50, 0.5, -12)
            toggleBox.Size = UDim2.fromOffset(24, 24)
            toggleBox.Parent = toggle1

            local toggleCorner = Instance.new("UICorner")
            toggleCorner.CornerRadius = UDim.new(0, 4)
            toggleCorner.Parent = toggleBox

            local checkmark = Instance.new("ImageLabel")
            checkmark.Name = "checkmark"
            checkmark.Image = "rbxassetid://7072718552"
            checkmark.ImageColor3 = Color3.fromRGB(255, 255, 255)
            checkmark.ImageTransparency = 1
            checkmark.BackgroundTransparency = 1
            checkmark.Size = UDim2.new(1, -4, 1, -4)
            checkmark.Position = UDim2.fromOffset(2, 2)
            checkmark.Parent = toggleBox

            local tog = false

            toggle1.MouseButton1Click:Connect(function()
                tog = not tog
                callback(tog)
                if tog then
                    TweenService:Create(toggleBox, TweenInfo.new(0.2), {BackgroundColor3 = Color3.fromRGB(100, 150, 255)}):Play()
                    TweenService:Create(checkmark, TweenInfo.new(0.2), {ImageTransparency = 0}):Play()
                else
                    TweenService:Create(toggleBox, TweenInfo.new(0.2), {BackgroundColor3 = Color3.fromRGB(50, 50, 50)}):Play()
                    TweenService:Create(checkmark, TweenInfo.new(0.2), {ImageTransparency = 1}):Play()
                end
            end)
        end

        function ElementHandler:Textbox(text, callback)
            text = text or "Textbox"
            callback = callback or function() end

            local textboxFrame = Instance.new("Frame")
            textboxFrame.Name = "textbox"
            textboxFrame.BackgroundTransparency = 1
            textboxFrame.Size = UDim2.new(1, 0, 0, 50)
            textboxFrame.Parent = holder

            local textboxLabel = Instance.new("TextLabel")
            textboxLabel.Font = Enum.Font.Gotham
            textboxLabel.Text = text
            textboxLabel.TextColor3 = Color3.fromRGB(200, 200, 200)
            textboxLabel.TextSize = 13
            textboxLabel.TextXAlignment = Enum.TextXAlignment.Left
            textboxLabel.BackgroundTransparency = 1
            textboxLabel.Size = UDim2.new(1, 0, 0, 20)
            textboxLabel.Parent = textboxFrame

            local textBox = Instance.new("TextBox")
            textBox.Name = "textBox"
            textBox.Font = Enum.Font.Gotham
            textBox.PlaceholderText = "Enter value..."
            textBox.PlaceholderColor3 = Color3.fromRGB(120, 120, 120)
            textBox.Text = ""
            textBox.TextColor3 = Color3.fromRGB(255, 255, 255)
            textBox.TextSize = 13
            textBox.TextXAlignment = Enum.TextXAlignment.Left
            textBox.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
            textBox.Position = UDim2.fromOffset(0, 25)
            textBox.Size = UDim2.new(1, 0, 0, 32)
            textBox.Parent = textboxFrame

            local textBoxCorner = Instance.new("UICorner")
            textBoxCorner.CornerRadius = UDim.new(0, 6)
            textBoxCorner.Parent = textBox

            local textBoxPadding = Instance.new("UIPadding")
            textBoxPadding.PaddingLeft = UDim.new(0, 10)
            textBoxPadding.PaddingRight = UDim.new(0, 10)
            textBoxPadding.Parent = textBox

            textBox.FocusLost:Connect(function(enterPressed)
                if enterPressed then
                    callback(textBox.Text)
                end
            end)
        end

        function ElementHandler:Dropdown(text, options, callback)
            text = text or "Dropdown"
            options = options or {}
            callback = callback or function() end

            local dropdown = Instance.new("Frame")
            dropdown.Name = "dropdown"
            dropdown.BackgroundTransparency = 1
            dropdown.Size = UDim2.new(1, 0, 0, 50)
            dropdown.ClipsDescendants = false
            dropdown.Parent = holder

            local dropLabel = Instance.new("TextLabel")
            dropLabel.Font = Enum.Font.Gotham
            dropLabel.Text = text
            dropLabel.TextColor3 = Color3.fromRGB(200, 200, 200)
            dropLabel.TextSize = 13
            dropLabel.TextXAlignment = Enum.TextXAlignment.Left
            dropLabel.BackgroundTransparency = 1
            dropLabel.Size = UDim2.new(1, 0, 0, 20)
            dropLabel.Parent = dropdown

            local dropButton = Instance.new("TextButton")
            dropButton.Name = "dropButton"
            dropButton.Font = Enum.Font.Gotham
            dropButton.Text = ""
            dropButton.TextColor3 = Color3.fromRGB(200, 200, 200)
            dropButton.TextSize = 13
            dropButton.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
            dropButton.Position = UDim2.fromOffset(0, 25)
            dropButton.Size = UDim2.new(1, 0, 0, 32)
            dropButton.AutoButtonColor = false
            dropButton.Parent = dropdown

            local dropCorner = Instance.new("UICorner")
            dropCorner.CornerRadius = UDim.new(0, 6)
            dropCorner.Parent = dropButton

            local selectedLabel = Instance.new("TextLabel")
            selectedLabel.Font = Enum.Font.Gotham
            selectedLabel.Text = "Select..."
            selectedLabel.TextColor3 = Color3.fromRGB(200, 200, 200)
            selectedLabel.TextSize = 13
            selectedLabel.TextXAlignment = Enum.TextXAlignment.Left
            selectedLabel.BackgroundTransparency = 1
            selectedLabel.Position = UDim2.fromOffset(12, 0)
            selectedLabel.Size = UDim2.new(1, -40, 1, 0)
            selectedLabel.Parent = dropButton

            local arrow = Instance.new("TextLabel")
            arrow.Font = Enum.Font.GothamBold
            arrow.Text = "▼"
            arrow.TextColor3 = Color3.fromRGB(200, 200, 200)
            arrow.TextSize = 10
            arrow.BackgroundTransparency = 1
            arrow.Position = UDim2.new(1, -25, 0, 0)
            arrow.Size = UDim2.fromOffset(20, 32)
            arrow.Parent = dropButton

            local optionsList = Instance.new("Frame")
            optionsList.Name = "optionsList"
            optionsList.BackgroundColor3 = Color3.fromRGB(45, 45, 45)
            optionsList.Position = UDim2.fromOffset(0, 60)
            optionsList.Size = UDim2.new(1, 0, 0, 0)
            optionsList.ClipsDescendants = true
            optionsList.ZIndex = 5
            optionsList.Parent = dropdown

            local optionsCorner = Instance.new("UICorner")
            optionsCorner.CornerRadius = UDim.new(0, 6)
            optionsCorner.Parent = optionsList

            local optionsLayout = Instance.new("UIListLayout")
            optionsLayout.Padding = UDim.new(0, 2)
            optionsLayout.SortOrder = Enum.SortOrder.LayoutOrder
            optionsLayout.Parent = optionsList

            local optionsPadding = Instance.new("UIPadding")
            optionsPadding.PaddingTop = UDim.new(0, 4)
            optionsPadding.PaddingBottom = UDim.new(0, 4)
            optionsPadding.PaddingLeft = UDim.new(0, 4)
            optionsPadding.PaddingRight = UDim.new(0, 4)
            optionsPadding.Parent = optionsList

            local isOpen = false

            for _, option in pairs(options) do
                local optionBtn = Instance.new("TextButton")
                optionBtn.Name = option
                optionBtn.Font = Enum.Font.Gotham
                optionBtn.Text = option
                optionBtn.TextColor3 = Color3.fromRGB(200, 200, 200)
                optionBtn.TextSize = 12
                optionBtn.TextXAlignment = Enum.TextXAlignment.Left
                optionBtn.BackgroundColor3 = Color3.fromRGB(55, 55, 55)
                optionBtn.Size = UDim2.new(1, -8, 0, 28)
                optionBtn.AutoButtonColor = false
                optionBtn.Parent = optionsList

                local optionCorner = Instance.new("UICorner")
                optionCorner.CornerRadius = UDim.new(0, 4)
                optionCorner.Parent = optionBtn

                local optionPadding = Instance.new("UIPadding")
                optionPadding.PaddingLeft = UDim.new(0, 10)
                optionPadding.Parent = optionBtn

                optionBtn.MouseEnter:Connect(function()
                    TweenService:Create(optionBtn, TweenInfo.new(0.15), {BackgroundColor3 = Color3.fromRGB(70, 70, 70)}):Play()
                end)

                optionBtn.MouseLeave:Connect(function()
                    TweenService:Create(optionBtn, TweenInfo.new(0.15), {BackgroundColor3 = Color3.fromRGB(55, 55, 55)}):Play()
                end)

                optionBtn.MouseButton1Click:Connect(function()
                    selectedLabel.Text = option
                    callback(option)
                    isOpen = false
                    TweenService:Create(optionsList, TweenInfo.new(0.2), {Size = UDim2.new(1, 0, 0, 0)}):Play()
                    TweenService:Create(arrow, TweenInfo.new(0.2), {Rotation = 0}):Play()
                end)
            end

            dropButton.MouseButton1Click:Connect(function()
                isOpen = not isOpen
                if isOpen then
                    local totalHeight = (#options * 30) + 8
                    TweenService:Create(optionsList, TweenInfo.new(0.2), {Size = UDim2.new(1, 0, 0, totalHeight)}):Play()
                    TweenService:Create(arrow, TweenInfo.new(0.2), {Rotation = 180}):Play()
                else
                    TweenService:Create(optionsList, TweenInfo.new(0.2), {Size = UDim2.new(1, 0, 0, 0)}):Play()
                    TweenService:Create(arrow, TweenInfo.new(0.2), {Rotation = 0}):Play()
                end
            end)
        end

        return ElementHandler
    end
    
    -- Drag functionality (Mobile + Desktop)
    local dragging = false
    local dragInput
    local dragStart
    local startPos

    local function update(input)
        local delta = input.Position - dragStart
        TweenService:Create(main, TweenInfo.new(0.1), {Position = UDim2.new(startPos.X.Scale, startPos.X.Offset + delta.X, startPos.Y.Scale, startPos.Y.Offset + delta.Y)}):Play()
        TweenService:Create(shadow, TweenInfo.new(0.1), {Position = UDim2.new(startPos.X.Scale, startPos.X.Offset + delta.X, startPos.Y.Scale, startPos.Y.Offset + delta.Y)}):Play()
    end

    topBar.InputBegan:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then
            dragging = true
            dragStart = input.Position
            startPos = main.Position
            
            input.Changed:Connect(function()
                if input.UserInputState == Enum.UserInputState.End then
                    dragging = false
                end
            end)
        end
    end)

    topBar.InputChanged:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseMovement or input.UserInputType == Enum.UserInputType.Touch then
            dragInput = input
        end
    end)

    UserInputService.InputChanged:Connect(function(input)
        if input == dragInput and dragging then
            update(input)
        end
    end)

    -- Make first tab visible
    task.spawn(function()
        repeat task.wait() until tabList:FindFirstChildOfClass("TextButton")
        local firstTab = tabList:FindFirstChildOfClass("TextButton")
        if firstTab then
            firstTab.BackgroundTransparency = 0
            firstTab.TextColor3 = Color3.fromRGB(255, 255, 255)
            for _, v in pairs(contentContainer:GetChildren()) do
                if v.Name == "container" then
                    v.Visible = true
                    break
                end
            end
        end
    end)

    -- Startup sound
    spawn(function()
        if table.StartupSound and table.StartupSound.Toggle and table.StartupSound.SoundID ~= nil then
            local sound = Instance.new('Sound', game.CoreGui)
            sound.Name = "Startup Sound"
            sound.SoundId = table.StartupSound.SoundID
            sound.Volume = 1.5
            sound.TimePosition = table.StartupSound.TimePosition or 0
            sound:Play()
            sound.Stopped:Wait()
            sound:Destroy()
        end
    end)

    return tabHandler
end

return Library
